"use strict";!function(t){function e(e,i){var n=t("#"+e.attr("id")),a=new s(n,i);return a.parent=n.parent(),a.handle=a.parent.find(".candlestick-toggle"),a.settings=i.customVars(i),a["default"]={},a["default"].id=a.element.attr("id"),a["default"].value=a.element.val(),a["default"].name=a.element.attr("name"),a["default"].data=a.element.data(),a}var i={};t.fn.candlestick=function(n){if("val"==n)return t(this).find('input[type="hidden"]')?t(this).find('input[type="hidden"]').val():t(this).val();var a=!0;if("undefined"!=typeof n)if("boolean"==typeof n.swipe)a=n.swipe;else if("object"==typeof n.swipe&&"undefined"!=typeof n.swipe.enabled&&"boolean"==typeof n.swipe.enabled){var o={enabled:!0,mobile:!0,desktop:!0,transition:!1};a=t.extend(o,n.swipe)}var l={mode:"options",contents:{left:"Left",middle:"Middle",right:"Right",swipe:!1},on:"1",off:"0",nc:"",size:"md",swipe:a,debug:!1,allowManualDefault:!0,afterAction:function(){},afterRendering:function(){},afterOrganization:function(){},afterSetting:function(){},customVars:function(t){return t}};if(i[t(this).attr("id")]&&(l=i[t(this).attr("id")]),"string"==typeof n&&t(this).attr("id"))switch(n){case"on":return this.each(function(){var i=e(t(this),l);i.defaultOrganization(),i.setBackground("on"),i.setHandle(1)});case"off":return this.each(function(){var i=e(t(this),l);i.defaultOrganization(),i.setBackground("off"),i.setHandle(-1)});case"reset":case"default":return this.each(function(){var i=e(t(this),l);l.allowManualDefault&&(i.defaultOrganization(),i.setValue(0))});case"enable":return this.each(function(){var i=e(t(this),l);i.parent.removeClass("candlestick-disabled")});case"disable":return this.each(function(){var i=e(t(this),l);i.parent.addClass("candlestick-disabled")})}var d=t.extend(l,n);return this.each(function(){if("checkbox"==t(this).attr("type"))if(t(this).attr("id")){var e=new s(t(this),d);i[t(this).attr("id")]=d,e.initialize()}else t.error("Candlestick needs an unique id attribute to store settings !!!");else t.error("Candlestick only used on checkbox input fields !!!")})};var s=function(t,e){this.element=t,this.settings=e.customVars(e),this["default"]={},this.getMode("contents")&&this.settings.contents.swipe&&(this.settings.swipe=!1)};s.prototype.initialize=function(){this.log("initialize"),this["default"].id=this.element.attr("id"),this["default"].value=this.element.val(),this["default"].name=this.element.attr("name"),this["default"].data=this.element.data(),this.wrapElement(),this["delete"](),this.settings.afterRendering()&&this.settings.afterRendering(this.element,this.parent),this.defaultOrganization(),this.settings.afterOrganization()&&this.settings.afterOrganization(this.element,this.parent),this.assignValue(),this.actions()},s.prototype.wrapElement=function(){this.log("Create HTMLCandlestick element");var t="",e="";e=this["default"].id?this["default"].id:this["default"].name.replace(/[\[\]]/gi,""),this.log("ID : "+e),this["default"].id=e;var i="";if(this["default"].data){var s=this["default"].data;for(var n in s)i+=" data-"+n+'="'+s[n]+'"'}var a="";this.element.attr("disabled")&&(t=" candlestick-disabled",a=" disabled");var o="";switch(this.element.attr("readonly")&&(t=" candlestick-disabled readonly",o=" readonly"),this.isSwipeEnable()&&(t+=" grab"),this.settings.allowManualDefault||(t+=" candlestick-default-disabled"),this.settings.mode){case"contents":var l='<div class="candlestick-wrapper candlestick-contents"><div data-candlestick-id="'+e+'" class="candlestick-bg'+t+'"><div class="candlestick-toggle"></div><div class="candlestick-off" data-content="'+this.settings.contents.left+'"></div>';this.settings.contents.middle&&(l+='<div class="candlestick-nc" data-content="'+this.settings.contents.middle+'"></div>'),l+='<div class="candlestick-on" data-content="'+this.settings.contents.right+'"></div><input type="hidden" class="'+this.element.attr("class")+'" value="'+this["default"].value+'" name="'+this["default"].name+'" id="'+e+'"'+i+a+o+"></div></div>";break;default:var l='<div class="candlestick-wrapper candlestick-size-'+this.settings.size+'"><div data-candlestick-id="'+e+'" class="candlestick-bg'+t+'"><div class="candlestick-toggle"></div><div class="candlestick-off"><i class="fa fa-times"></i></div><div class="candlestick-nc">&nbsp;</div><div class="candlestick-on"><i class="fa fa-check"></i></div><input type="hidden" class="'+this.element.attr("class")+'" value="'+this["default"].value+'" name="'+this["default"].name+'" id="'+e+'"'+i+a+o+"></div></div>"}this.element.wrap(l)},s.prototype.assignValue=function(){var t=this["default"].value;(typeof t==typeof this.settings.on&&t==this.settings.on||typeof t==typeof this.settings.off&&t==this.settings.off)&&this.setPositionByValue(t)},s.prototype.setValue=function(t){var e="";0==t?e=this.settings.nc:t>0?e=this.settings.on:t<0&&(e=this.settings.off),this.element.val(e),this.settings.afterSetting&&this.settings.afterSetting(this.element,this.parent,e)},s.prototype.setHandle=function(t){var e="",i=0;return 0==t?(this.defaultOrganization(),this.settings.afterAction(this.element,this.parent,"default"),void this.setValue(t)):(t>0?(i=this.parent.outerWidth()-this.parent.find(".candlestick-toggle").outerWidth(),e="on"):t<0&&(e="off"),this.settings.afterAction(this.element,this.parent,e),this.handle.css("left",i),void this.setValue(t))},s.prototype.setPositionByValue=function(t){t==this.settings.on?(this.setBackground("on"),this.setHandle(1)):t==this.settings.off&&(this.setBackground("off"),this.setHandle(-1))},s.prototype.setBackground=function(t){this.parent.removeClass("on").removeClass("default").removeClass("off"),this.parent.addClass(t)},s.prototype.defaultOrganization=function(){var t=this.parent.outerHeight(),e=this.parent.outerWidth(),i=(this.handle.outerWidth(),this.handle.outerWidth()),s=this.handle.outerHeight();this.parent.addClass("default"),this.parent.removeClass("on").removeClass("off"),this.handle.css({top:(t-s)/2,left:e/2-i/2})},s.prototype.mouseContents=function(){var e=this;t(".candlestick-bg").on("mousedown",function(i){i.preventDefault(),i.stopPropagation(),e.mouseEvent={leftElement:100,offsetX:0},t(this).addClass("move"),e.mouseEvent.leftElement=parseInt(t(this).find(".candlestick-toggle").css("left")),e.mouseEvent.offsetX=i.pageX}).on("mousemove",function(i){var s;if(i.preventDefault(),i.stopPropagation(),t(this).hasClass("move")){s=i.pageX<e.mouseEvent.offsetX?i.pageX-e.mouseEvent.offsetX:i.pageX-e.mouseEvent.offsetX;var n=e.slot(t(this),s);t(this).find(".candlestick-toggle").css("left",n)}}).on("mouseup",function(i){i.preventDefault(),i.stopPropagation(),t(this).removeClass("move"),e.placeToggle(t(this))})},s.prototype.placeToggle=function(t){var e=parseInt(t.find(".candlestick-toggle").innerWidth()),i=parseInt(t.find(".candlestick-toggle").css("left"));i<=e?(this.log("Off position"),i<e/2?(this.log("putOff event"),this.putOff()):(this.log("putDefault event"),this.putDefault())):(this.log("Other position (except Off)"),i>=e+e/2?(this.log("On position"),this.putOn()):(this.log("default position"),this.putDefault("default")))},s.prototype.slot=function(t,e){var i=this.mouseEvent.leftElement+e,s=parseInt(t.find(".candlestick-toggle").innerWidth()),n=2*s;return i>n&&(i=n),i<0&&(i=0),i},s.prototype.actions=function(){this.actionOn(),this.actionOff(),this.actionDefault(),this.isSwipeEnable()?(this.log("Swipe is enable. Swipe event is On."),this.actionSwipe()):this.getMode("contents")&&(this.log('"contents" mode. Mouse event is enable.'),this.mouseContents())},s.prototype.actionOn=function(){var t=this;this.parent.find(".candlestick-on").on("click",function(e){e.preventDefault(),t.putOn()})},s.prototype.putOn=function(){this.parent.hasClass("candlestick-disabled")||(this.setBackground("on"),this.setHandle(1))},s.prototype.actionOff=function(){var t=this;this.parent.find(".candlestick-off").on("click",function(e){e.preventDefault(),t.putOff()})},s.prototype.putOff=function(){this.parent.hasClass("candlestick-disabled")||(this.setBackground("off"),this.setHandle(-1))},s.prototype.putToggle=function(t){if(!this.parent.hasClass("candlestick-disabled"))switch(t){case"left":this.element.val()==this.settings.on?(this.setBackground(""),this.setHandle(0)):this.element.val()==this.settings.nc&&this.putOff();break;case"right":return this.element.val()==this.settings.off?(this.setBackground(""),this.setHandle(0)):this.element.val()==this.settings.nc&&this.putOn(),!1}},s.prototype.actionDefault=function(){var t=this;this.parent.find(".candlestick-nc").on("click",function(e){e.preventDefault(),!t.parent.hasClass("candlestick-disabled")&&t.settings.allowManualDefault&&t.putDefault("default")})},s.prototype.putDefault=function(t){this.setBackground(t),this.setHandle(0)},s.prototype.actionSwipe=function(){var e=this;if(e.isSwipeEnable())if("undefined"!=typeof t.fn.hammer){e.log("Hammerjs is enable");var i=e.parent.find(".candlestick-toggle");e.getMode("contents")&&(i=e.parent),i.hammer({threshold:0,velocity:.1}).bind("panleft",function(t){return e.getMode("contents")||(t.preventDefault(),t.stopPropagation(),e.settings.swipe.transition?e.putToggle("left"):e.putOff()),!1}).bind("panright",function(t){return e.getMode("contents")||(t.preventDefault(),t.stopPropagation(),e.settings.swipe.transition?e.putToggle("right"):e.putOn()),!1}).bind("swipeleft",function(i){e.getMode("contents")&&e.swipeElementContents(t(this),-1)}).bind("swiperight",function(i){e.getMode("contents")&&e.swipeElementContents(t(this),1)})}else t.error("You have to load hammerjs && jquery-hammerjs lib to use swipe option")},s.prototype.swipeElementContents=function(t,e){var i=parseInt(this.handle.innerWidth()),s=parseInt(this.handle.css("left"));e>0?0==s?(this.log("Right swipe to default position"),this.settings.nc?this.putDefault():this.putOff()):(this.log("Right swipe to on position"),this.putOn()):e<0&&(s>0&&s>2*i?(this.log("Left swipe to default position"),this.settings.nc?this.putDefault():this.putOn()):(this.log("Left swipe to off position"),this.putOff()))},s.prototype.isSwipeEnable=function(){var t=!0;return"boolean"==typeof this.settings.swipe?t=this.settings.swipe:"object"==typeof this.settings.swipe&&(t=this.settings.swipe.enabled),t},s.prototype.getMode=function(t){return this.settings.mode==t},s.prototype["delete"]=function(){this.element.remove(),this.parent=t('[data-candlestick-id="'+this["default"].id+'"]'),this.handle=this.parent.find(".candlestick-toggle"),this.element=t("#"+this["default"].id)},s.prototype.log=function(t){this.settings.debug&&console.log(t)}}(jQuery);