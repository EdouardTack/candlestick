"use strict";!function(t){t.fn.candlestick=function(e){if("val"==e)return t(this).find('input[type="hidden"]')?t(this).find('input[type="hidden"]').val():t(this).val();var i=!0;if("undefined"!=typeof e)if("boolean"==typeof e.swipe)i=e.swipe;else if("object"==typeof e.swipe&&"undefined"!=typeof e.swipe.enabled&&"boolean"==typeof e.swipe.enabled){var s={enabled:!0,mobile:!0,desktop:!0,transition:!1};i=t.extend(s,e.swipe)}var n={mode:"options",contents:{left:"Left",middle:"Middle",right:"Right",swipe:!1},on:"1",off:"0","default":"",size:"md",swipe:i,debug:!1,afterAction:function(){},afterRendering:function(){},afterOrganization:function(){},afterSetting:function(){}};if("reset"==e)return this.each(function(){var e=t('[data-candlestick-id="'+t(this).attr("id")+'"]');if(e){var i=new Candlestick(e,n);i.parent=e,i.handle=e.find(".candlestick-toggle"),i.element=t("#"+t(this).attr("id")),i.defaultOrganization(),i.setValue(0)}});var a=t.extend(n,e);return this.each(function(){if("checkbox"==t(this).attr("type")){var e=new Candlestick(t(this),a);e.initialize()}else t.error("Candlestick only used on checkbox input fields !!!")})}}(jQuery);var Candlestick=function(t,e){this.element=t,this.settings=e,this["default"]={},this.getMode("contents")&&this.settings.contents.swipe&&(this.settings.swipe=!1)};Candlestick.prototype.initialize=function(){this["default"].id=this.element.attr("id"),this["default"].value=this.element.val(),this["default"].name=this.element.attr("name"),this["default"].data=this.element.data(),this.wrapElement(),this["delete"](),this.settings.afterRendering()&&this.settings.afterRendering(this.element,this.parent),this.defaultOrganization(),this.settings.afterOrganization()&&this.settings.afterOrganization(this.element,this.parent),this.assignValue(),this.actions()},Candlestick.prototype.wrapElement=function(){var t="",e="";e=this["default"].id?this["default"].id:this["default"].name.replace(/[\[\]]/gi,""),this["default"].id=e;var i="";if(this["default"].data){var s=this["default"].data;for(d in s)i+=" data-"+d+'="'+s[d]+'"'}var n="";this.element.attr("disabled")&&(t=" candlestick-disabled",n=" disabled");var a="";switch(this.element.attr("readonly")&&(t=" candlestick-disabled readonly",a=" readonly"),this.isSwipeEnable()&&(t+=" grab"),this.settings.mode){case"contents":var o='<div class="candlestick-wrapper candlestick-contents"><div data-candlestick-id="'+e+'" class="candlestick-bg'+t+'"><div class="candlestick-toggle"></div><div class="candlestick-off" data-content="'+this.settings.contents.left+'"></div><div class="candlestick-nc" data-content="'+this.settings.contents.middle+'"></div><div class="candlestick-on" data-content="'+this.settings.contents.right+'"></div><input type="hidden" class="'+this.element.attr("class")+'" value="'+this["default"].value+'" name="'+this["default"].name+'" id="'+e+'"'+i+n+a+"></div></div>";break;default:var o='<div class="candlestick-wrapper candlestick-size-'+this.settings.size+'"><div data-candlestick-id="'+e+'" class="candlestick-bg'+t+'"><div class="candlestick-toggle"></div><div class="candlestick-off"><i class="fa fa-times"></i></div><div class="candlestick-nc">&nbsp;</div><div class="candlestick-on"><i class="fa fa-check"></i></div><input type="hidden" class="'+this.element.attr("class")+'" value="'+this["default"].value+'" name="'+this["default"].name+'" id="'+e+'"'+i+n+a+"></div></div>"}this.element.wrap(o)},Candlestick.prototype.assignValue=function(){var t=this["default"].value;(typeof t==typeof this.settings.on&&t==this.settings.on||typeof t==typeof this.settings.off&&t==this.settings.off)&&this.setPositionByValue(t)},Candlestick.prototype.setValue=function(t){var e="";0==t?e=this.settings["default"]:t>0?e=this.settings.on:0>t&&(e=this.settings.off),this.element.val(e),this.settings.afterSetting&&this.settings.afterSetting(this.element,this.parent,e)},Candlestick.prototype.setHandle=function(t){if(0==t)return this.defaultOrganization(),this.settings.afterAction()&&this.settings.afterAction(this.element,this.parent,"default"),void this.setValue(t);if(t>0)var e=this.parent.outerWidth()-this.parent.find(".candlestick-on").outerWidth(),i="on";else if(0>t)var e=0,i="off";this.settings.afterAction()&&this.settings.afterAction(this.element,this.parent,i),this.handle.css("left",e),this.setValue(t)},Candlestick.prototype.setPositionByValue=function(t){t==this.settings.on?(this.setBackground("on"),this.setHandle(1)):t==this.settings.off&&(this.setBackground("off"),this.setHandle(-1))},Candlestick.prototype.setBackground=function(t){this.parent.removeClass("on").removeClass("default").removeClass("off"),this.parent.addClass(t)},Candlestick.prototype.defaultOrganization=function(){var t=this.parent.outerHeight(),e=this.parent.outerWidth(),i=(this.handle.outerWidth(),this.handle.outerWidth()),s=this.handle.outerHeight();this.parent.addClass("default"),this.parent.removeClass("on").removeClass("off"),this.handle.css({top:(t-s)/2,left:e/2-i/2})},Candlestick.prototype.mouseContents=function(){var t=this;$(".candlestick-bg").on("mousedown",function(e){e.preventDefault(),e.stopPropagation(),t.mouseEvent={leftElement:100,offsetX:0},$(this).addClass("move"),t.mouseEvent.leftElement=parseInt($(this).find(".candlestick-toggle").css("left")),t.mouseEvent.offsetX=e.pageX}).on("mousemove",function(e){if(e.preventDefault(),e.stopPropagation(),$(this).hasClass("move")){if(e.pageX<t.mouseEvent.offsetX)var i=e.pageX-t.mouseEvent.offsetX;else var i=e.pageX-t.mouseEvent.offsetX;var s=t.slot($(this),i);$(this).find(".candlestick-toggle").css("left",s)}}).on("mouseup",function(e){e.preventDefault(),e.stopPropagation(),$(this).removeClass("move"),t.placeToggle($(this))})},Candlestick.prototype.placeToggle=function(t){var e=parseInt(t.find(".candlestick-toggle").innerWidth()),i=parseInt(t.find(".candlestick-toggle").css("left"));e>=i?(this.log("Off position"),e/2>i?(this.log("putOff event"),this.putOff()):(this.log("putDefault event"),this.putDefault())):(this.log("Other position (except Off)"),i>=e+e/2?(this.log("On position"),this.putOn()):(this.log("default position"),this.putDefault("default")))},Candlestick.prototype.slot=function(t,e){var i=this.mouseEvent.leftElement+e,s=parseInt(t.find(".candlestick-toggle").innerWidth()),n=2*s;return i>n&&(i=n),0>i&&(i=0),i},Candlestick.prototype.actions=function(){this.actionOn(),this.actionOff(),this.actionDefault(),this.isSwipeEnable()?(this.log("Swipe is enable. Swipe event is On."),this.actionSwipe()):this.getMode("contents")&&(this.log('"contents" mode. Mouse event is enable.'),this.mouseContents())},Candlestick.prototype.actionOn=function(){var t=this;this.parent.find(".candlestick-on").on("click",function(e){e.preventDefault(),t.putOn()})},Candlestick.prototype.putOn=function(){this.parent.hasClass("candlestick-disabled")||(this.setBackground("on"),this.setHandle(1))},Candlestick.prototype.actionOff=function(){var t=this;this.parent.find(".candlestick-off").on("click",function(e){e.preventDefault(),t.putOff()})},Candlestick.prototype.putOff=function(){this.parent.hasClass("candlestick-disabled")||(this.setBackground("off"),this.setHandle(-1))},Candlestick.prototype.putToggle=function(t){if(!this.parent.hasClass("candlestick-disabled"))switch(t){case"left":this.element.val()==this.settings.on?(this.setBackground(""),this.setHandle(0)):this.element.val()==this.settings["default"]&&this.putOff();break;case"right":return this.element.val()==this.settings.off?(this.setBackground(""),this.setHandle(0)):this.element.val()==this.settings["default"]&&this.putOn(),!1}},Candlestick.prototype.actionDefault=function(){var t=this;this.parent.find(".candlestick-nc").on("click",function(e){e.preventDefault(),t.parent.hasClass("candlestick-disabled")||t.putDefault("default")})},Candlestick.prototype.putDefault=function(t){this.setBackground(t),this.setHandle(0)},Candlestick.prototype.actionSwipe=function(){var t=this;if(t.isSwipeEnable())if("undefined"!=typeof $.fn.hammer){t.log("Hammerjs is enable");var e=t.parent.find(".candlestick-toggle");if(t.getMode("contents"))var e=t.parent;e.hammer({threshold:0,velocity:.1}).bind("panleft",function(e){return t.getMode("contents")||(e.preventDefault(),e.stopPropagation(),t.settings.swipe.transition?t.putToggle("left"):t.putOff()),!1}).bind("panright",function(e){return t.getMode("contents")||(e.preventDefault(),e.stopPropagation(),t.settings.swipe.transition?t.putToggle("right"):t.putOn()),!1}).bind("swipeleft",function(e){t.getMode("contents")&&t.swipeElementContents($(this),-1)}).bind("swiperight",function(e){t.getMode("contents")&&t.swipeElementContents($(this),1)})}else $.error("You have to load hammerjs && jquery-hammerjs lib to use swipe option")},Candlestick.prototype.swipeElementContents=function(t,e){var i=parseInt(this.handle.innerWidth()),s=parseInt(this.handle.css("left"));e>0?0==s?(this.log("Right swipe to default position"),this.putDefault()):(this.log("Right swipe to on position"),this.putOn()):0>e&&(s>0&&s>2*i?(this.log("Left swipe to default position"),this.putDefault()):(this.log("Left swipe to off position"),this.putOff()))},Candlestick.prototype.isSwipeEnable=function(){var t=!0;return"boolean"==typeof this.settings.swipe?t=this.settings.swipe:"object"==typeof this.settings.swipe&&(t=this.settings.swipe.enabled),t},Candlestick.prototype.getMode=function(t){return this.settings.mode==t},Candlestick.prototype["delete"]=function(){this.element.remove(),this.parent=$('[data-candlestick-id="'+this["default"].id+'"]'),this.handle=this.parent.find(".candlestick-toggle"),this.element=$("#"+this["default"].id)},Candlestick.prototype.log=function(t){this.settings.debug&&console.log(t)};